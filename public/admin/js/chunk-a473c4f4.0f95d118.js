(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a473c4f4"],{8485:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.relationshipSetup?n("v-sheet",[n("v-select",{staticClass:"language-picker",attrs:{options:e.options.languages,icon:"translate"},model:{value:e.currentLanguage,callback:function(t){e.currentLanguage=t},expression:"currentLanguage"}}),n("hr"),!1===e.loading&&null!==e.initialValues?n("div",{staticClass:"body"},[n("v-form",{key:e.currentLanguage,attrs:{"full-width":"",collection:e.relation.collection_many.collection,fields:e.translatedFields,values:e.currentLanguageValues,"primary-key":e.existing&&e.existing[e.translationsCollectionPrimaryKeyField]},on:{"stage-value":e.saveLanguage}})],1):n("v-spinner")],1):n("v-notice",{attrs:{color:"warning",icon:"warning"}},[e._v(" "+e._s(e.$t("relationship_not_setup"))+" ")])},i=[],l=(n("99af"),n("7db0"),n("d81d"),n("b64b"),n("d3b7"),n("07ac"),n("ddb0"),n("96cf"),n("1da1")),r=n("2909"),u=n("ade3"),s=n("8db2"),o=n.n(s),c={mixins:[o.a],data:function(){return{currentLanguage:Object.keys(this.options.languages)[0],loading:!1,initialValues:null,relationalChanges:[]}},computed:{translatedFields:function(){var e=this;if(!1!==this.relationshipSetup)return _.mapValues(this.relation.collection_many.fields,(function(t){return t=_.clone(t),t.field===e.relation.field_many.field&&(t.readonly=!0),t}))},defaults:function(){return _.mapValues(_.clone(this.translatedFields),(function(e){return e.default_value}))},existing:function(){return _.find(this.initialValues,Object(u["a"])({},this.options.languageField,this.currentLanguage))},translationsCollectionPrimaryKeyField:function(){return Object.values(this.relation.collection_many.fields).find((function(e){return!0===e.primary_key})).field},currentLanguageValues:function(){var e=_.find(this.relationalChanges,Object(u["a"])({},this.options.languageField,this.currentLanguage));return _.merge({},this.existing||this.defaults,e)},relationshipSetup:function(){var e;return!!(null===(e=this.relation)||void 0===e?void 0:e.collection_many)},currentPrimaryKey:function(){var e=_.find(this.fields,{primary_key:!0}),t=e.field;return this.values[t]}},watch:{relationalChanges:{deep:!0,handler:function(e){e&&this.$emit("input",e)}}},created:function(){this.fetchInitial()},methods:{saveLanguage:function(e){var t=this,n=e.field,a=e.value,i=_.find(this.relationalChanges,Object(u["a"])({},this.options.languageField,this.currentLanguage));if(i)this.relationalChanges=this.relationalChanges.map((function(e){return e[t.options.languageField]===t.currentLanguage?_.merge({},e,Object(u["a"])({},n,a)):e}));else{var l,s=(l={},Object(u["a"])(l,n,a),Object(u["a"])(l,this.options.languageField,this.currentLanguage),l);if(this.existing){var o=_.find(this.translatedFields,{primary_key:!0}).field,c=this.existing[o];s[o]=c}this.relationalChanges=[].concat(Object(r["a"])(this.relationalChanges),[s])}},fetchInitial:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var n,a,i,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!1!==e.relationshipSetup){t.next=2;break}return t.abrupt("return");case 2:if(!e.newItem){t.next=5;break}return e.initialValues=[],t.abrupt("return");case 5:return e.loading=!0,n=e.relation.collection_many.collection,a=e.relation.field_many.field,t.next=10,e.$api.getItems(n,{filter:Object(u["a"])({},a,{eq:e.currentPrimaryKey})});case 10:i=t.sent,l=i.data,e.initialValues=l,e.loading=!1;case 14:case"end":return t.stop()}}),t)})))()}}},d=c,f=(n("a043"),n("2877")),g=Object(f["a"])(d,a,i,!1,null,"43f399dc",null);t["default"]=g.exports},"8b4e":function(e,t,n){},"8db2":function(e,t){e.exports={props:{id:{type:String,required:!0},name:{type:String,required:!0},value:{type:null,default:null},type:{type:String,required:!0},length:{type:[String,Number],default:null},readonly:{type:Boolean,default:!1},collection:{type:String,default:null},primaryKey:{type:[Number,String],default:null},required:{type:Boolean,default:!1},options:{type:Object,default:()=>({})},newItem:{type:Boolean,default:!1},relation:{type:Object,default:null},fields:{type:Object,default:null},values:{type:Object,default:null},width:{type:String,default:null,validator(e){return["half","half-left","half-right","full","fill"].includes(e)}}}}},a043:function(e,t,n){"use strict";var a=n("8b4e"),i=n.n(a);i.a}}]);
//# sourceMappingURL=chunk-a473c4f4.0f95d118.js.map